# 決済システムの選定

## 要件

- アカウント作成前: 3回無料
- アカウント作成後: 月10回無料
- 上位プランで利用回数/入力サイズ上限が緩和
- 従量課金は不要

## 比較

| 項目 | Stripe | Polar.sh |
|------|--------|----------|
| 手数料 | 2.9% + 30¢ | 4% + 40¢ |
| 税務処理 | 自己責任 | MoR(込み) |
| 導入難易度 | 中〜高 | 低(6行で統合可) |
| サブスクリプション | 高機能 | シンプル |
| 従量課金 | 対応 | 対応 |
| オープンソース | No | Yes |

## 推奨: Polar.sh

理由:
1. **Merchant of Record** — 税務(VAT, 消費税等)をPolar側で処理。グローバル展開時の負担が大幅に減る
2. **シンプルな料金体系** — Ultrahopeの「プランごとに上限が変わる」モデルに合う
3. **開発者体験** — Next.js/ElysiaJSとの統合が容易。6行で実装可能
4. **手数料差は許容範囲** — 1.1%+10¢の差はMoRサービス込みと考えれば安い

## 実装方針

1. プラン設計:
   - Free: 月10回、入力サイズ制限あり
   - Pro ($X/月): 月100回、入力サイズ緩和
   - Team ($Y/月): 無制限

2. 未認証ユーザーの3回制限はAPI側でIPベースまたはデバイスIDで管理

3. Polar SDKでチェックアウト・顧客ポータルを実装

## 参考

- https://polar.sh/docs
- https://polar.sh/resources/comparison/stripe
